- defaults:
    link:
      relink: true
      stdin: true
      stdout: true
    shell:
      stdin: true
      stdout: true
      stderr: true

- clean: ['~']

- create:
  - ~/.local
  - ~/repos
  - ~/Desktop
  - ~/Documents
  - ~/Downloads
  - ~/Music
  - ~/Pictures/Screenshots
  - ~/Public
  - ~/Templates
  - ~/Videos

- link:
    ~/.local/share/fonts: .local/share/fonts
    ~/bin: scripts

    ~/.mime.types: home/.mime.types
    ~/.zshrc: home/.zshrc

    ~/.config/bat: config/bat
    ~/.config/dunst: config/dunst
    ~/.config/imv: config/imv
    ~/.config/kitty: config/kitty
    ~/.config/lazygit: config/lazygit
    ~/.config/macchina: config/macchina
    ~/.config/mpv: config/mpv
    ~/.config/neofetch: config/neofetch
    ~/.config/paru: config/paru
    ~/.config/ranger: config/ranger
    ~/.config/rofi: config/rofi
    ~/.config/spaceship: config/spaceship
    ~/.config/spotify-tui: config/spotify-tui
    ~/.config/spotifyd: config/spotifyd
    ~/.config/sway: config/sway
    ~/.config/swaylock: config/swaylock
    ~/.config/waybar: config/waybar
    ~/.config/yt-dlp: config/yt-dlp
    ~/.config/zathura: config/zathura

- shell:
  - [git submodule update --init --recursive, Installing git submodules]
  -
    command: >-
      if [[ "$(grep "/${USER}:" /etc/passwd | awk -F '/' '{print $NF}')" != "zsh" ]] ; then chsh -s $(which zsh) ; fi
    description: Making zsh the default shell
  -
    command: >-
      if [[ ! -d ~/Pictures/wallpapers ]] ; then git clone https://github.com/notchum/wallpapers ~/Pictures/wallpapers ; fi
    description: Installing wallpapers to ~/Pictures/wallpapers
  -
    command: >-
      tldr --update
    description: Updating tealdeer cache
  -
    command: >-
      git update-index --assume-unchanged $(pwd)/config/spotifyd/spotifyd.conf
    description: Updating spotifyd git index
  -
    command: >-
      if paru -Qs gnu-free-fonts >/dev/null ; then paru -R --noconfirm gnu-free-fonts ; fi
    description: Removing gnu-free-fonts if installed
    stdin: true
  -
    command: >-
      cd $XDG_DATA_HOME/fonts && curl -O https://github.com/adi1090x/rofi/raw/refs/heads/master/fonts/Icomoon-Feather.ttf
    description: Installing Feather icon font for rofi

- crontab:
  - cron: "*/2 * * * *"
    command: DISPLAY=:0 DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus $HOME/bin/laptop/check_battery.sh
